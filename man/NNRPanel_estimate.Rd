% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/NNRPanel_estimate.R
\name{NNRPanel_estimate}
\alias{NNRPanel_estimate}
\title{The proposed estimator with bias corrections.}
\usage{
NNRPanel_estimate(
  data_frame,
  phi,
  func,
  delta = 0.05,
  R_max = 5,
  R_true,
  s = 10,
  iter_max = 10000,
  tol = 1e-08
)
}
\arguments{
\item{data_frame}{Panel data in long format (data frame or matrix). The first
column must contain individual IDs, the second column the time index, and
the third column the outcome variable \code{Y}; all remaining columns are
treated as covariates in the regression model. The panel is required to be
balanced.}

\item{phi}{Optional tuning parameter for the NNR estimator. If omitted, a
data-driven value is computed internally via
\code{calculate_tuning_parameter()} using the same \code{data_frame},
\code{func}, \code{delta}, \code{R_max}, \code{s}, \code{iter_max}, and
\code{tol}.}

\item{func}{A character string indicating the outcome model:
\code{"logit"} for logistic regression, \code{"probit"} for Probit regression, and \code{"poisson"} for Poisson
regression.}

\item{delta}{Inflation factor used when computing a data-driven \eqn{\varphi}.
The tuning parameter is set proportional to \eqn{(1 + \delta)} times the
leading singular value of an appropriate residual matrix.}

\item{R_max}{Maximum number of factors allowed when selecting the factor
dimension in the data-driven rank selection step.}

\item{R_true}{Optional integer giving the “true” number of factors. If
supplied, the function reports both the FE and bias-corrected estimates
using \code{R_true}, in addition to the data-driven results based on
\code{num_factor_est}. If missing, only the data-driven versions are
returned.}

\item{s}{Initial step size used in the inner optimization routines for both
the NNR and MLE steps. This value serves as the starting step size for the line-search procedure.}

\item{iter_max}{Maximum number of iterations used in the MLE step.}

\item{tol}{Convergence tolerance for the optimization routines. Iterations
stop when the change in parameters or objective falls below this threshold.}
}
\value{
A list containing at least
  \describe{
    \item{\code{beta_nnr}}{NNR estimator of the regression coefficients.}
    \item{\code{num_factor_est}}{Data-driven estimate of the number of factors.}
    \item{\code{beta_fe_data}}{Second-step MLE coefficient estimates based
      on \code{num_factor_est}.}
    \item{\code{beta_corr_data}}{Analytically bias-corrected estimates based
      on \code{num_factor_est}.}
    \item{\code{beta_corr_sp_data}}{Sample-splitting bias-corrected estimates
      based on \code{num_factor_est}.}
    \item{\code{std_beta_corr_data}}{Estimated standard errors  based on
      based on \code{num_factor_est}.}
  }
  If \code{R_true} is provided, the list additionally includes
  \describe{
    \item{\code{beta_fe}}{Second step MLE coefficient estimates using \code{R_true}.}
    \item{\code{beta_corr}}{Analytically bias-corrected estimates using
      \code{R_true}.}
    \item{\code{beta_corr_sp}}{Sample-splitting bias-corrected estimates
      using \code{R_true}.}
    \item{\code{std_beta_corr}}{Estimated standard errors based on 
      \code{R_true}.}
  }
}
\description{
Implements the nonlinear nuclear norm–regularized (NNR) estimator with
interactive fixed effects for panel data, followed by a second-step MLE and
analytical / sample-splitting bias corrections. The function also reports the standard error.
The procedure supports both logit and Poisson outcome models. It accommodates 
either a prespecified tuning parameter \eqn{\varphi} or a data-driven one 
obtained via \code{calculate_tuning_parameter()}. 
In addition, the function computes results using both the data-driven estimate 
of the number of factors and, when provided by the user, a prespecified \code{R_true}.
}
\examples{
\dontrun{
data_list <- gen_data_logit(N = 200, T = 200, num_factor = 2,
                              num_Z = 1, beta = c(0.2))
data_frame <- list_to_data_frame(data_list)

# Logit model with data-driven phi and rank
est_logit <- NNRPanel_estimate(
  data_frame = data_frame,
  func       = "logit",
  delta      = 0.05,
  R_max      = 5
)

# Poisson model with user-specified phi and known R_true
est_logit <- NNRPanel_estimate(
  data_frame = data_frame,
  phi        = 5,
  func       = "logit",
  delta      = 0.05,
  R_max      = 5,
  R_true     = 2
)
}

}
